{% load static %}
<!-- Modal para Editar Cliente -->
<div class="modal fade" id="clienteEditModal" tabindex="-1" aria-labelledby="clienteEditModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <!-- Contenedor para cargar el formulario dinámicamente -->
            <div id="formContainer"></div>
        </div>
    </div>
</div>

<!-- CSS y scripts globales -->

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script type="module">
    import { showErrorAlert, showSuccessAlert } from "{% static 'crm/alerts.js' %}";
    
    document.getElementById('clienteEditModal').addEventListener('shown.bs.modal', function(event) {
        const button = event.relatedTarget;
        const formContainer = this.querySelector('#formContainer');
        const editUrl = button.getAttribute('data-url');
        
        fetch(editUrl, {
            headers: {
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.text())
        .then(html => {
            formContainer.innerHTML = html;
            // Disparar evento para inicialización
            document.dispatchEvent(new CustomEvent('ajaxFormLoaded', {
                detail: { form: formContainer.querySelector('form') }
            }));
        })
        .catch(error => {
            console.error('Error loading form:', error);
            showErrorAlert('Error al cargar el formulario de edición');
        });
    });
</script>